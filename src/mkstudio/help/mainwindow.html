<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=windows-1251">
  <title>Главное окно</title>
  <link href="help.css" rel="stylesheet" type="text/css">
</head>

<body>
<h3><a name="anchor1"></a>Начальный диалог</h3>

<p>После запуска программы MKStudio появляется окно начального диалога:</p>

<p><img alt="" src="img/initdialog.png"></p>

<p>Здесь необходимо задать параметры интерфейса для взаимодействия с сетью
МК.</p>

<table border="1" cellpadding="3" cellspacing="1" width="100%">
  <tbody>
    <tr>
      <th>Параметр</th>
      <th>Описание</th>
    </tr>
    <tr>
      <td><span class="menuitem">Порт</span></td>
      <td>Имя последовательного порта или <em>Modbus TCP</em> для работы по
        TCP/IP.</td>
    </tr>
    <tr>
      <td><span class="menuitem">Скорость / Хост</span></td>
      <td>Скорость передачи данных последовательного порта или имя сервера для
        Modbus TCP.</td>
    </tr>
    <tr>
      <td><span class="menuitem">Таймаут</span></td>
      <td>Значение тайм-аута ответа (в мс).</td>
    </tr>
    <tr>
      <td><span class="menuitem">Макс. длина пакета</span></td>
      <td>Максимальная длина пакета в байтах, допустимая в данной сети МК.</td>
    </tr>
    <tr>
      <td class="menuitem">Ожидание между запросами</td>
      <td>Время (в мс) между получением ответа и посылкой следующего
      запроса.</td>
    </tr>
    <tr>
      <td class="menuitem">Цикл опроса</td>
      <td>Минимальное время (в мс) полного цикла опроса.</td>
    </tr>
  </tbody>
</table>

<p>Подробности про организацию сети МК <a href="project_set.html#anchor2">см.
здесь.</a></p>

<h3>Главное окно</h3>

<p><img alt="" src="img/mainwindow.png" height="596" width="729"></p>

<p>Главное окно программы MKStudio содержит:</p>
<ul>
  <li>строку меню,</li>
  <li>панели инструментов, дублирующие пункты меню,</li>
  <li>центральную область с таблицей,</li>
  <li><a href="#anchor2">прикрепляемые окна</a>: 
    <ul>
      <li>Сообщения,</li>
      <li>Взаимодействие с МК,</li>
      <li>Конфигурация сети МК,</li>
      <li>Дополнения,</li>
    </ul>
  </li>
  <li><a href="#anchor3">строку состояния</a>.</li>
</ul>

<p>Меню <span class="menuitem">Файл</span></p>

<table border="1" cellpadding="3" cellspacing="1" width="100%">
  <tbody>
    <tr>
      <th valign="middle">Пункт меню</th>
      <th valign="top">Описание</th>
    </tr>
    <tr>
      <td valign="middle"><span class="menuitem">Новый проект</span></td>
      <td valign="top">Создает новый проект</td>
    </tr>
    <tr>
      <td valign="middle"><span class="menuitem">Загрузить проект</span></td>
      <td valign="top">Загружает проект из файла проекта.</td>
    </tr>
    <tr>
      <td valign="middle"><span class="menuitem">Сохранить проект</span></td>
      <td valign="top">Сохраняет текущий проект в файл проекта.</td>
    </tr>
    <tr>
      <td valign="middle" class="menuitem"><span class="menuitem">Сохранить
        проект как</span></td>
      <td valign="top">Сохраняет текущий проект в файл проекта с указанным
        именем.</td>
    </tr>
    <tr>
      <td valign="middle" class="menuitem">Экспорт конфигурации</td>
      <td>Экспортирует текущую конфигурацию в текстовый файл.</td>
    </tr>
    <tr>
      <td valign="middle" class="menuitem"><span class="menuitem">Сохранить
        значения параметров</span></td>
      <td valign="top">Сохраняет текущие значения параметров информационной
        базы МК в файл. (Доступен только при работе информационного обмена с
      МК)</td>
    </tr>
    <tr>
      <td valign="middle"><span class="menuitem">Загрузить значения
        параметров</span></td>
      <td valign="top">Загружает сохраненные в файле значения параметров
        информационной базы и записывает их в МК. (Доступен только при работе
        информационного обмена с МК)</td>
    </tr>
  </tbody>
</table>

<p>Меню <span class="menuitem">Правка</span></p>

<table border="1" cellpadding="3" cellspacing="1" width="100%">
  <tbody>
    <tr>
      <th valign="middle">Пункт меню</th>
      <th>Описание</th>
    </tr>
    <tr>
      <td valign="middle"><span class="menuitem">Отмена</span><br>
      </td>
      <td>Отменяет последнее действие при редактировании таблицы. Возможна
        отмена нескольких действий подряд.</td>
    </tr>
    <tr>
      <td valign="middle"><span class="menuitem">Повтор</span><br>
      </td>
      <td>Восстанавливает последнее отмененное действие.</td>
    </tr>
    <tr>
      <td valign="middle"><span class="menuitem">Копировать</span><br>
      </td>
      <td>Копирует содержимое выделенной области ячеек таблицы во внутренний
        буфер.</td>
    </tr>
    <tr>
      <td valign="middle"><span class="menuitem">Вырезать</span><br>
      </td>
      <td>Копирует содержимое выделенной области ячеек таблицы во внутренний
        буфер, а затем очищает ячейки.</td>
    </tr>
    <tr>
      <td valign="middle"><span class="menuitem">Вставить</span><br>
      </td>
      <td>Вставляет ячейки из временного буфера в таблицу в позицию текущей
        ячейки.</td>
    </tr>
  </tbody>
</table>

<p>Меню <span class="menuitem">Вид</span></p>

<table border="1" cellpadding="3" cellspacing="1" width="100%">
  <tbody>
    <tr>
      <th valign="middle">Пункт меню</th>
      <th>Описание</th>
    </tr>
    <tr>
      <td valign="middle"><span class="menuitem">Настройки</span><br>
      </td>
      <td>Вызывает <a href="#anchor4">окно настройки программы</a>.</td>
    </tr>
    <tr>
      <td valign="middle"><span class="menuitem">Конфигурация сети МК</span><br>
      </td>
      <td>Отображает/скрывает прикрепленное окно <span
        class="menuitem">Конфигурация сети МК</span>.</td>
    </tr>
    <tr>
      <td valign="middle"><span class="menuitem">Взаимодействие с МК</span><br>
      </td>
      <td>Отображает/скрывает прикрепленное окно <span
        class="menuitem">Взаимодействие с МК</span>.</td>
    </tr>
    <tr>
      <td valign="middle"><span class="menuitem">Сообщения</span><br>
      </td>
      <td>Отображает/скрывает прикрепленное окно <span
        class="menuitem">Сообщения</span>.</td>
    </tr>
    <tr>
      <td valign="middle"><span class="menuitem">Дополнения</span><br>
      </td>
      <td>Отображает/скрывает прикрепленное окно <span
        class="menuitem">Дополнения</span>.</td>
    </tr>
    <tr>
      <td valign="middle"><span class="menuitem">Панель инструментов</span><br>
      </td>
      <td>Отображает/скрывает главную панель инструментов.</td>
    </tr>
    <tr>
      <td valign="middle"><span class="menuitem">Вставка и удаление</span></td>
      <td>Отображает/скрывает панель инструментов вставки и удаления ячеек
        таблицы.</td>
    </tr>
  </tbody>
</table>

<p>Меню <span class="menuitem">Таблица</span> </p>

<table border="1" cellpadding="3" cellspacing="1" width="100%">
  <tbody>
    <tr>
      <th valign="middle">Пункт меню</th>
      <th>Описание</th>
    </tr>
    <tr>
      <td valign="middle"><span class="menuitem">Размер</span> &gt; <span
        class="menuitem">Строки</span><br>
      </td>
      <td>Задает количество строк в таблице.</td>
    </tr>
    <tr>
      <td valign="middle"><span class="menuitem">Размер</span> &gt; <span
        class="menuitem">Столбцы</span><br>
      </td>
      <td>Задает количество столбцов в таблице.</td>
    </tr>
    <tr>
      <td valign="middle"><span class="menuitem">Вставить</span> &gt; <span
        class="menuitem">Строку</span><br>
      </td>
      <td>Вставляет строку  в позицию текущей ячейки.</td>
    </tr>
    <tr>
      <td valign="middle"><span class="menuitem">Вставить</span> &gt; <span
        class="menuitem">Столбец</span></td>
      <td>Вставляет столбец  в позицию текущей ячейки.</td>
    </tr>
    <tr>
      <td valign="middle"><span class="menuitem">Вставить</span> &gt; <span
        class="menuitem">Ячейку со сдвигом вправо</span></td>
      <td>Вставляет новую ячейку в позицию текущей ячейки. При этом действии
        значения всех ячейках текущей строки, находящиеся правее позиции
        вставки, сдвигаются направо на одну позицию.</td>
    </tr>
    <tr>
      <td valign="middle"><span class="menuitem">Вставить</span> &gt; <span
        class="menuitem">Ячейку со сдвигом вниз</span></td>
      <td>Вставляет новую ячейку в позицию текущей ячейки. При этом действии
        значения во всех ячейках текущего столбца, находящиеся ниже позиции
        вставки, сдвигаются вниз на одну позицию.</td>
    </tr>
    <tr>
      <td valign="middle"><span class="menuitem">Удалить</span> &gt; <span
        class="menuitem">Строку</span></td>
      <td>Удаляет строку  в позиции текущей ячейки.</td>
    </tr>
    <tr>
      <td valign="middle"><span class="menuitem">Удалить</span> &gt; <span
        class="menuitem">Столбец</span></td>
      <td>Вставляет строку  в позиции текущей ячейки.</td>
    </tr>
    <tr>
      <td valign="middle"><span class="menuitem">Удалить</span> &gt; <span
        class="menuitem">Ячейку со сдвигом влево</span></td>
      <td>Удаляет текущую ячейку. При этом действии значения всех ячеек текущей
        строки, находящиеся правее места удаления, сдвигаются влево на одну
        позицию. </td>
    </tr>
    <tr>
      <td valign="middle"><span class="menuitem">Удалить</span> &gt; <span
        class="menuitem">Ячейку со сдвигом вверх</span></td>
      <td>Удаляет текущую ячейку. При этом действии значения всех ячеек
        текущего столбца, находящиеся ниже места удаления, сдвигаются вверх на
        одну позицию.</td>
    </tr>
    <tr>
      <td valign="middle"><span class="menuitem">Выделение</span><br>
      </td>
      <td>Включает/отключает полужирное начертание шрифта для выделенных
      ячеек.</td>
    </tr>
    <tr>
      <td valign="middle"><span class="menuitem">Наклон</span></td>
      <td>Включает/отключает наклонное начертание шрифта для выделенных
      ячеек.</td>
    </tr>
    <tr>
      <td valign="middle"><span class="menuitem">Подчеркивание</span></td>
      <td>Включает/отключает подчеркивание текста для выделенных ячеек.</td>
    </tr>
    <tr>
      <td valign="middle"><span class="menuitem">Влево</span></td>
      <td>Задает выравнивание текста к левому краю для выделенных ячеек.</td>
    </tr>
    <tr>
      <td valign="middle"><span class="menuitem">По центру</span></td>
      <td>Задает выравнивание текста по центру краю для выделенных ячеек.</td>
    </tr>
    <tr>
      <td valign="middle"><span class="menuitem">Вправо</span></td>
      <td>Задает выравнивание текста к правому краю для выделенных ячеек.</td>
    </tr>
    <tr>
      <td valign="middle"><span class="menuitem">Цвет текста</span></td>
      <td>Задает цвет текста для выделенных ячеек.</td>
    </tr>
    <tr>
      <td valign="middle"><span class="menuitem">Цвет фона</span></td>
      <td>Задает цвет фона для выделенных ячеек.</td>
    </tr>
    <tr>
      <td valign="middle"><span class="menuitem">Привязка</span></td>
      <td>Задает <a href="project_set.html#anchor3">привязку</a> для выделенных
        ячеек.</td>
    </tr>
  </tbody>
</table>

<p>Меню <span class="menuitem">Команды</span> </p>

<table border="1" cellpadding="3" cellspacing="1" width="100%">
  <tbody>
    <tr>
      <th valign="middle">Пункт меню</th>
      <th>Описание</th>
    </tr>
    <tr>
      <td valign="middle"><span class="menuitem">Пуск </span></td>
      <td>Запускает информационный обмен между MKStudio и сетью МК. Программа
        переходит в <a href="project_run.html">режим работы с проектом</a>.</td>
    </tr>
    <tr>
      <td valign="middle"><span class="menuitem">Стоп </span></td>
      <td>Останавливает информационный обмен между MKStudio и сетью МК. 
        Программа переходит в <a href="project_set.html">режим редактирования
        проекта</a>.</td>
    </tr>
  </tbody>
</table>

<p>Меню <span class="menuitem">Помощь</span> </p>

<table border="1" cellpadding="3" cellspacing="1" width="100%">
  <tbody>
    <tr>
      <th valign="middle">Пункт меню</th>
      <th>Описание</th>
    </tr>
    <tr>
      <td valign="middle"><span class="menuitem">Руководство </span></td>
      <td>Вызывает данное руководство пользователя.</td>
    </tr>
    <tr>
      <td valign="middle"><span class="menuitem">О программе </span></td>
      <td>Показывает информацию о программе.</td>
    </tr>
  </tbody>
</table>

<h3><a name="anchor2"></a>Прикрепляемые окна</h3>

<p><em>Прикрепляемые окна</em> - это дочерние окна главного окна программы,
которые могут быть:</p>
<ul>
  <li>прикреплены к любой области по периметру главного окна,</li>
  <li>объединены с другим прикрепляемым окном,</li>
  <li>отображаться отдельно в виде самостоятельного окна,</li>
  <li>скрыты.</li>
</ul>

<p>Управление положением прикрепляемого окна производится перетаскиванием его
заголовка. Для этого надо подвести указатель мыши к заголовку окна, нажать
левую клавишу мыши, и, удерживая ее, перемещать окно на требуемую позицию. При
совпадении заголовком двух окон они объединяются, их дальнейший выбор
осуществляется по закладкам. Скрывать и показывать прикрепляемые окна можно из
меню <span class="menuitem">Вид</span>.</p>

<h4><a name="anchor6"></a>Окно <span class="menuitem">Сообщения</span></h4>

<p><img alt="" src="img/mainwindow_console.png" height="146" width="298"></p>

<p>В это окно программа выводит различные сообщения: </p>
<ul>
  <li>сообщения об ошибках</li>
  <li>служебные информационные сообщения,</li>
  <li>содержимое пакетов протокола MODBUS-RTU MIKKON информационного обмена с
    МК (по требованию).</li>
</ul>

<p>Нажатие кнопки <span class="menuitem">Очистить</span> удаляет все сообщения.
При установленном флажке <span class="menuitem">автопрокрутка</span> окно
всегда показывает последние сообщения. </p>

<h4><a name="anchor5"></a>Окно <span class="menuitem">Взаимодействие с
МК</span> </h4>

<p><img alt="" src="img/mainwindow_opros.png" height="254" width="509"></p>

<p>В режиме настройки проекта это окно пусто. После запуска проекта в этом окне
отображается состояние информационного обмена с МК. </p>

<p>Поля таблицы повторяют поля из окна <span class="menuitem">Конфигурация сети
МК</span>. Цвет поля <span class="menuitem">N</span> для данного слота
обозначает: </p>
<ul>
  <li>серый - слот не активен,</li>
  <li>зеленый - обмен информацией с МК происходит без ошибок,</li>
  <li>красный - обмен информацией с МК происходит с ошибками.</li>
</ul>

<p>При двойном нажатии кнопки мыши на строчке таблицы вызывается окно со
значениями параметров слота. Подробности <a
href="project_run.html#anchor1">здесь</a>.</p>

<h4>Окно <span class="menuitem">Конфигурация сети МК</span></h4>

<p><img alt="" src="img/mainwindow_modules.png" height="273" width="847"></p>

<p>В этом окне задается конфигурация сети МК данного проекта. Подробности <a
href="project_set.html#anchor2">здесь</a>. </p>

<h4>Окно <span class="menuitem">Дополнения</span> </h4>

<p><img alt="" src="img/mainwindow_script.png" height="270" width="473"> </p>

<p>В этом окне задаются дополнительные настройки отображения ячеек таблицы.
Подробности <a href="project_set.html#anchor5">здесь</a>. </p>

<h3><a name="anchor3"></a>Строка состояния </h3>

<p>В стороке состяния выводятся следующие данные: </p>

<table border="1" cellpadding="3" cellspacing="1" width="100%">
  <tbody>
    <tr>
      <th valign="middle">Название поля</th>
      <th>Описание</th>
    </tr>
    <tr>
      <td valign="middle">Время цикла</td>
      <td>Время полного цикла информационного обмена с сетью МК в миллисекундах
        . Данное время показывает максимальное время, прошедшее между
        изменением значения параметра в информационной базе МК и его
        отображением в программе MKStudio. </td>
    </tr>
    <tr>
      <td valign="middle">Запросы</td>
      <td>Счетчик пакетов запроса к МК по протоколу MODBUS-RTU MIKKON.
        Увеличение этого счетчика показывает, что MKStudio обращается к МК.</td>
    </tr>
    <tr>
      <td valign="middle">Ответы</td>
      <td>Счетчик пакетов ответа МК по протоколу MODBUS-RTU MIKKON. Увеличение
        этого счетчика показывает, что MKStudio получает правильные ответы от
        MK.</td>
    </tr>
    <tr>
      <td valign="middle">Ошибки</td>
      <td>Счетчик ошибок протокола MODBUS-RTU MIKKON. Увеличение этого счетчика
        показывает, что при обмене информацией между MKStudio и сетью MK
        возникают ошибки.</td>
    </tr>
  </tbody>
</table>

<h3><a name="anchor4"></a>Настройка программы </h3>

<p>Окно настройки программы вызывается через меню <span
class="menuitem">Вид</span> &gt; <span class="menuitem">Настройки</span>. </p>

<p><img alt="" src="img/mainwindow_settings.png"> </p>

<p>В группе <span class="menuitem">Шрифт</span> задаются используемые шрифты
отдельно для таблицы и всего остального интерфейса.<br>
</p>

<p>Флажок <span class="menuitem">Выводить пакеты в окно сообщений</span>
позволяет выводить в <a href="#anchor6">окно Сообщений</a> все пакеты
информационного обмена с МК. <span class="menuitem">Максимальная длина
пакета</span> задает максимальный размер пакетов протокола. Эта настройка
вступает в силу после запуска (перезапуска) проекта. <span
class="menuitem">Пропускать неиспользуемые транзакции</span> включает режим,
при котором пропускаются тракзакции, предназанченные для опроса параметров, не
отображаемых на экране в данный момент.</p>
</body>
</html>
