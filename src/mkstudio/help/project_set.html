<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=windows-1251">
  <title>Настройка проекта</title>
  <link type="text/css" rel="stylesheet" href="help.css">
</head>

<body>
<p>Проект MKStudio содержит:</p>
<ul>
  <li>конфигурацию сети МК</li>
  <li>вид центральной таблицы главного окна.</li>
</ul>

<p>Настройка проекта осуществляется в режиме работы MKStudio, когда не запущен
информационный обмен с МК. Программа переходит в этот режим сразу после запуска
или после вызова меню <span class="menuitem">Команды</span> &gt; <span
class="menuitem">Стоп</span>. Если меню <span class="menuitem">Команды</span>
содержит пункт <span class="menuitem">Пуск</span>, то это значит, что программа
находиться в нужном режиме.</p>

<h3>Управление проектами</h3>

<p>Проекты MKStudio сохраняются в файлах с расширением XML. Они представляют из
себя текстовые файлы, сформированные в соответствии со стандартом языка
разметки XML. В файле проекта сохраняется конфигурация сети МК и вид таблицы
центральной области главного окна.</p>

<p>Создание проекта</p>

<p>Новый проект создается при помощи меню <span class="menuitem">Файл</span>
&gt; <span class="menuitem">Новый проект</span><span
class="menuitem"></span>.</p>

<p>Загрузка проекта</p>

<p>Чтобы загрузить проект нужно вызвать пункт меню <span
class="menuitem">Файл</span> &gt; <span class="menuitem">Загрузить
проект</span><span class="menuitem"></span>. После этого, в появившемся
стандартном окне выбора файла задать нужный файл проекта.</p>

<p>Сохранение проекта</p>

<p>Для сохранения текущего проекта  нужно вызвать пункт меню <span
class="menuitem">Файл</span> &gt; <span class="menuitem">Сохранить
проект</span><span class="menuitem"></span>. При этом действии проект
сохраняется в тот же файл, который был загружен ранее. Если текущий проект не
имеет своего файла (т.е. проект был создан, а не загружен), то появляется
стандартное окно сохранения файла. Там нужно указать имя файла, в который будет
сохранен проект. Также можно сохранить проект в файл, отличный от текущего,
воспользовавшись пунктом <span class="menuitem">Сохранить проект
как</span><span class="menuitem"></span>.</p>

<h3><a name="anchor2"></a>Настройка информационного взаимодействия с сетью
МК</h3>

<p>Сеть МК представляет собой один или несколько МК, присоединенных к ПК через
последовательный интерфейс. При этом, необходимо чтобы на всех МК в пределах
одной сети был задан уникальный для этой сети адрес и выставленна одинаковая
скорость. Программа MKStudio позволяет работать с одной сетью МК. Настройка
параметров последовательного интерфейса (имя порта, скорость и тайм-аут ответа)
осуществляется в <a href="mainwindow.html#anchor1">окне начального диалога</a>
сразу после запуска программы.</p>

<p>Модулем называется МК в составе данной сети.</p>

<p>Слотом называется область информационной базы модуля, содержащая массив
однотипных параметров для отображения или управления.</p>

<p>Для того, чтобы настроить информационное взаимодействие с сетью МК нужно
задать задать параметры в окне <span class="menuitem">Конфигурация сети
МК</span>.</p>

<p>Окно представляет из себя две таблицы. Левая таблица (модули) содержит
список всех МК сети. Правая таблица задает слоты для модуля, указанного
выделенной строкой левой таблицы Таким образом, для каждого МК из таблицы cлева
существует своя таблица слотов cправа.</p>

<p><img alt="" src="img/mainwindow_modules.png" height="273" width="847"></p>

<p>Таблица <span class="menuitem">Модули</span>:</p>

<table border="1" cellpadding="3" cellspacing="1" width="100%">
  <tbody>
    <tr>
      <th>Название<br>
        столбца</th>
      <th>Значение</th>
    </tr>
    <tr>
      <td><span class="menuitem">N</span></td>
      <td>Номер МК. Заполняется автоматически. При <a
        href="#anchor3">привязке</a> используется для ссылки на данный МК.</td>
    </tr>
    <tr>
      <td><span class="menuitem">Узел</span></td>
      <td>MODBUS-адрес МК в сети. Десятичное число от 1 до 127. В случае
        использования в сети МК подузла (например, МК серии КАМА из ПТК УМИКОН)
        узел задается в виде:[узел].[расширение]. Например: 2.3. Расширение
        должен быть десятичным числом от 1 до 15</td>
    </tr>
    <tr>
      <td><span class="menuitem">Название</span></td>
      <td>Текстовый столбец с названием МК. Данный столбец заполнять
        необязательно.</td>
    </tr>
    <tr>
      <td><span class="menuitem">Описание</span></td>
      <td>Текстовый столбец с описанием МК. Данный столбец заполнять
        необязательно.</td>
    </tr>
  </tbody>
</table>

<p>Таблица <span class="menuitem">Слоты</span>:</p>

<table border="1" cellpadding="3" cellspacing="1" width="100%">
  <tbody>
    <tr>
      <th>Название<br>
        столбца</th>
      <th>Значение</th>
    </tr>
    <tr>
      <td><span class="menuitem">N</span></td>
      <td>Номер слота. Заполняется автоматически. При <a
        href="#anchor3">привязке</a> используется для ссылки на слот.</td>
    </tr>
    <tr>
      <td><span class="menuitem">Адрес</span></td>
      <td>Смещение в байтах от начала информационной базы МК до начала данного
        слота. Задается шестнадцатеричным числом.</td>
    </tr>
    <tr>
      <td><span class="menuitem">Кол-во</span></td>
      <td>Количество (длина массива) параметров в данном слоте. Задается
        десятичным числом.<br>
      </td>
    </tr>
    <tr>
      <td><span class="menuitem">Тип</span></td>
      <td>Задает тип данных для параметров для данного слота (или просто тип
        слота). Возможные значения: 

        <table style="margin-left: 7px; width: 491px;" border="1"
        cellpadding="3" cellspacing="1" width="100%">
          <tbody>
            <tr>
              <th>Значение</th>
              <th>Описание</th>
            </tr>
            <tr>
              <td>биты</td>
              <td>Биты.</td>
            </tr>
            <tr>
              <td>байты</td>
              <td>Байты.</td>
            </tr>
            <tr>
              <td>слова</td>
              <td>Двухбайтовые целые числа.</td>
            </tr>
            <tr>
              <td>дв. слова</td>
              <td>Четырехбайтовые целые числа.</td>
            </tr>
            <tr>
              <td>вещ. числа</td>
              <td>Вещественные числа обычной точности (четырехбайтовые).</td>
            </tr>
          </tbody>
        </table>
        Переключение значений производится двойным нажатием левой кнопки мыши
        или нажатием клавиши Enter. </td>
    </tr>
    <tr>
      <td><span class="menuitem">Описание</span></td>
      <td>Текстовый столбец с описанием слота. Данный столбец заполнять
        необязательно.</td>
    </tr>
  </tbody>
</table>

<p>Для удаления строчки слота из таблицы нужно ввести пустой текст в поле <span
class="menuitem">Адрес</span>. При установке указателя мыши на поле <span
class="menuitem">Адрес</span>, во всплывающей подсказке будет показан расчетный
адрес этого слота, основанный на параметрах предыдущего слота. </p>

<h3>Настройка таблицы в центральной области главного окна </h3>

<p>Центральная область главного окна представляет собой таблицу. Она служит
для: </p>
<ul>
  <li>отображения статической информации,</li>
  <li>отображения параметров из информационной базы МК в реальном времени,</li>
  <li>управления параметрами информационной базы МК в реальном времени.</li>
</ul>
Редактирование таблицы осуществляется с использованием типичных приемов работы
с табличным редактором.<br>

<ul>
  <li>Количество строк или столбцов таблицы задается при помощи меню <span
    class="menuitem">Таблица</span> &gt; <span
  class="menuitem">Размер</span>.</li>
  <li>Вставить строку, столбец или ячейку в текущую позицию курсора можно при
    помощи меню <span class="menuitem">Таблица</span> &gt; <span
    class="menuitem">Вставить</span>.</li>
  <li>Удалить строку, столбец или ячейку, находящейся в текущей позиции
    курсора, можно при помощи меню <span class="menuitem">Таблица</span> &gt;
    <span class="menuitem">Удалить</span>.</li>
  <li>Набрать на клавиатуре содержимое текущей ячейки в виде текста (только
    если данная ячейка не привязана).</li>
</ul>
Для выделенной ячейки (или области из нескольких ячеек) можно: 
<ul>
  <li>Изменить начертание шрифта  при помощи пунктов меню <span
    class="menuitem">Таблица</span> &gt; <span
    class="menuitem">Выделение</span>, <span class="menuitem">Таблица</span>
    &gt; <span class="menuitem">Наклон</span> и <span
    class="menuitem">Таблица</span> &gt; <span
    class="menuitem">Подчеркивание</span>.<span class="menuitem"> </span></li>
  <li>Изменить центрирование текста при помощи пунктов меню <span
    class="menuitem">Таблица</span> &gt; <span class="menuitem">Влево</span>,
    <span class="menuitem">Таблица</span> &gt; <span class="menuitem">По
    центру</span> и <span class="menuitem">Таблица</span> &gt; <span
    class="menuitem">Вправо</span>.<span class="menuitem"> </span></li>
  <li>Очистить содержимое ячеек нажав клавишу Delete. При этом действии <a
    href="#anchor3">привязка</a> также удаляется.</li>
  <li>Запомнить содержимое ячеек в промежуточный буфер нажав клавишу Ctrl-C или
    из меню <span class="menuitem">Правка</span> &gt; <span
    class="menuitem">Копировать</span>.</li>
  <li>Запомнить содержимое ячеек в промежуточный буфер и очистить ячейки  при
    помощи пункта меню <span class="menuitem">Правка</span> &gt; <span
    class="menuitem">Вырезать</span>.</li>
  <li>Вставить содержимое ячеек из промежуточного буфера в таблицу
    нажав клавишу Ctrl-V или из меню <span class="menuitem">Правка</span> &gt;
    <span class="menuitem">Вставить</span>. При этом действии область вставки
    позиционируется таким образом, что ее левый верхний угол попадает в текущую
    позицию курсора.</li>
  <li>Изменить цвет текста ячейки при помощи пункта меню <span
    class="menuitem">Таблица</span> &gt; <span class="menuitem">Цвет
    текста</span>.</li>
  <li>Изменить цвет фона ячейки при помощи пункта меню <span
    class="menuitem">Таблица</span> &gt; <span class="menuitem">Цвет
    фона</span>.</li>
</ul>

<p>Все действия над таблицей можно последовательно отменять при помощи пункта
меню <span class="menuitem">Правка</span> &gt; <span
class="menuitem">Отмена</span>. </p>

<p>Все вышеописанные действия можно произвести из контекстного меню, доступного
по нажатию правой кнопки мыши на нужной ячейке. </p>

<h3><a name="anchor3"></a>Привязка ячейки к параметру информационной базы МК
</h3>

<p>Принцип привязки состоит в том, что в данной ячейке будет отображаться не
статический текст, а значение параметра из информационной базы МК в режиме
реального времени. Кроме отображения возможно управление этим параметром. </p>

<p>Для адресации параметра в сети МК используются поля <span
class="menuitem">N</span> из таблиц окна <span class="menuitem">Конфигурация
сети МК</span>. <a href="#anchor2">См. здесь</a>. Параметр задается тремя
числами: </p>
<ul>
  <li>Номер модуля (поле <span class="menuitem">N</span> из таблицы <span
    class="menuitem">Модули</span>)</li>
  <li>Номер слота (поле <span class="menuitem">N</span> из таблицы <span
    class="menuitem">Слоты)</span></li>
  <li>Номер (индекс) параметра в слоте. (Нумерация начинается с 1).</li>
</ul>

<p>Для настройки привязки используется диалог <span
class="menuitem">Привязка</span><br>
</p>

<p><img alt="" src="img/mainwindow_assign.png" height="355" width="255"><br>
</p>

<p>Порядок действий для привязки ячейки: </p>
<ol>
  <li>Выбрать отдельную ячейку или выделить прямоугольную область.</li>
  <li>Вызвать пункт меню <span class="menuitem">Таблица</span> &gt; <span
    class="menuitem">Привязка</span> (или нажать F4). Появится диалоговое окно
    "Привязка".</li>
  <li>Заполнить поля <span class="menuitem">Модуль</span>, <span
    class="menuitem">Слот</span>, <span class="menuitem">Номер</span> в
    соответствии с адресацией параметра.</li>
  <li>Если выбрана прямоугольная область ячеек, то привязка ячеек будет
    произведена с автоматическим инкрементом поля, параметры которого задаются
    в группе <span class="menuitem">Заполнение ячеек</span>. При выборе
    параметра <span class="menuitem">по строкам</span> или <span
    class="menuitem">по столбцам</span> становится доступен выбор типа поля:
    <span class="menuitem">модуль</span>, <span class="menuitem">слот</span>,
    или <span class="menuitem">номер</span>. </li>
  <li>Выбрать формат представления данных.</li>
  <li>Если ячейка подразумевает использование <a
    href="#anchor4">перечислителя</a>, то поле <span
    class="menuitem">Перечислитель</span> должно содержатьимя
    перечислителя.<span class="menuitem"></span> Подробности <a
    href="#anchor5">здесь</a>.</li>
  <li>Нажать кнопку <span class="menuitem">ОК</span> или клавишу Enter.</li>
</ol>

<p>После этого область ячеек будет выделенна специальным цветом (если не задан
иной цвет фона). Значение в ячейках показывает привязку в формате:</p>
<pre>      [номер модуля]/[номер слота]/[номер параметра].</pre>

<h3><a name="anchor5"></a>Окно Дополнения </h3>

<p>Для задания специальных настроек отображения некоторых ячеек используется
окно <span class="menuitem">Дополнения</span>. В нем в виде текста описываются
специальные виды отображения привязанных ячеек. </p>

<h4><a name="anchor4"></a>Перечислители</h4>

<p>Перечислитель представляет собой тип отображения, при котором различным
целочисленным значениям параметра соответствуют текстовые значения. При
отображении в таблице, ячейки с перечислителями будут содержать текстовые
значения, а при управлении будет появляться всплывающий список значений.</p>

<p>Формат описания перечислителя: </p>
<pre>enum [имя перечислителя]<br>{<br>  =[числовое значение]: [текстовое значение] // [необязательный комментарий]<br>  =[числовое значение]: [текстовое значение] // [необязательный комментарий] <br>...<br>  =[числовое значение]: [текстовое значение] // [необязательный комментарий]<br>}</pre>

<p>Имя перечислителя не должно содержать пробелов. Текстовое значение может
быть любым, но не должно содержать обозначения комментария ( // ). Числовое
значние может  быть отрицательно. В обозначении числового значения пробелы не
допускаются.</p>

<p>Например, режим работы генератора тока может быть описан так: </p>

<table style="width: 278px;" border="1" cellpadding="3" cellspacing="1"
width="100%">
  <tbody>
    <tr>
      <th>Числовое<br>
        значение</th>
      <th>Текстовое<br>
        значение</th>
    </tr>
    <tr>
      <td align="center">0</td>
      <td align="center">Отключен</td>
    </tr>
    <tr>
      <td align="center">1</td>
      <td align="center">1 мА</td>
    </tr>
    <tr>
      <td align="center">2</td>
      <td align="center">5 мА</td>
    </tr>
    <tr>
      <td align="center">3</td>
      <td align="center">20 мА</td>
    </tr>
  </tbody>
</table>
Тогда его текстовое описание <span class="menuitem"></span> должно выглядеть
так: 
<pre>enum Генератор_тока_режим<br>{<br>  =0: Отключен<br>  =1: 1 мА      // штатный режим<br>  =2: 5 мА<br>  =3: 20 мА<br>}</pre>

<p>При привязке ячейки таблицы в поле <span class="menuitem">Перечислитель
</span>диалога <span class="menuitem">Привязка</span> нужно ввести имя
перечислителя (в данном случае Генератор_тока_режим). </p>
</body>
</html>
